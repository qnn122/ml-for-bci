function  [f,y] = calc_fft(sig, Fs)
%CALC_FFT Calculate FFT of a signal
% 
% In:
%   sig     : the signal that needs analyzing
%   Fs      : sampling frequency
%
% Example:
%   [f, y] = calc_fft(sig, 250)
%   stem(f,y

windowL = length(sig);

% Set up parameters for Fourier transform
% Double number of FFT point by two time window Length, peak finding technique
NFFT = 2^nextpow2(windowL*2);       % Next power of 2 from length of y, required for fast fourier transform to perform at its best
f = Fs/2*linspace(0,1,NFFT/2+1);        % frequency series vector

% Perform fft
x = sig;             % Fraction of signal being analyzed
y_temp = fft(x,NFFT)/windowL;       % Perform Fourier Transform
y = 2*abs(y_temp(1:NFFT/2+1));      % Take absolute values and only the first half of the result since the second is just a mirror of the first one.

end

